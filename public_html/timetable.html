<!DOCTYPE html>
<html>
    <head>
        <title>Timetable Trial</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" />
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
        <script type="text/javascript">
            var data = ""; // data get from courseInfo.json (via data.php and .json updated by mkdata.php)
            var loaded = false; // check if data loaded when adding course
            
            $( document ).ready(function() {
                $.get( "http://ustcourser.442.hk/json/data.php" )
                  .done(function( _data ) {
                        data = $.parseJSON(_data);
                        loaded = true;
                        var searchhints = [];
                        $.each( data, function( key, val ) {
                            searchhints.push(key + " " + val["name"]);
                          });
                        $( "#add" ).autocomplete({
                                // source: "http://ustcourser.442.hk/json/parser.php?type=searchhints", 
                                source: searchhints,
                                minLength: 1,
                                focus: function( event, ui ) {
                                        event.preventDefault();
                                    }
                            });
                  });
                $("#timetable").delegate('td','mouseover mouseleave', function(e) {
                    if (e.type === 'mouseover') {
                      // $(this).parent().addClass("hover"); // row
                      $("colgroup").eq(Math.ceil($(this).index()/2)).addClass("hover"); // col
                    }
                    else {
                      // $(this).parent().removeClass("hover"); // row
                      $("colgroup").eq(Math.ceil($(this).index()/2)).removeClass("hover"); // col
                    }
                });
            });
            
            // JavaScript
            function addCourse() {
                if (!loaded) {
                    alert("Please try again later as data is still loading...");
                    return false;
                }
                var val = $("#add").val();
                var code = val.split(" ")[0];
                if (!data.hasOwnProperty(code)) {
                    alert("Course Not Found!");
                    return false;
                }
                $("#add").val(""); // clear input text
                return false; // always return false to avoid form submitting
            }
        </script>
        <style>
            #container {
                text-align: center;
                width: 1200px;
                margin: 0 auto;
            }
            .ui-autocomplete { 
                font-size: 15px;
                width: 400px; 
                line-height: 1.8em;
                max-height: 200px; 
                overflow-y: auto; 
                overflow-x: hidden;
            }
            #add {
                width: 400px;
                margin: 0 5px;
            }
            #addform {
                margin: 80px 0px 10px 0px;
                font-family: sans-serif;
                font-size: 16px;
                font-style: italic;
            }
            #timetable_wrapper {
                margin: 30px;
                cursor: default;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
            #timetable td {
                height: 70px;
                text-align: center;
                padding: 1px 0px;
            }
            #timetable th {
                border-right: 1px lightgray solid;
                padding-right: 8px;
                font-family: Courier New;
                width: 30px;
                background: white;
                text-shadow: 0px 0px 3px gray;
            }
            #timetable td {
                width: 40px;
            }
            #timetable tbody:hover {
                
            }
            .Mo, .Tu, .We, .Th, .Fr, .Su, .Sa {
                
            }
            .h08, .h09, .h10, .h11, .h12, .h13, .h14, .h15, .h16, .h17, .h18, .h19, .h20 {
                
            }
            .m00 {
                border-right: 1px transparent solid;
            }
            .m30 {
                border-right: 1px lightgray solid;
            }
            .m00, .m30 {
                border-top: 1px whitesmoke dotted;
                border-bottom: 1px whitesmoke dotted;
            }
            td.time {
                font-family: cursive;
                font-size: 0.8em;
            }
            td.alt {
                border-right: 1px transparent solid;
                visibility: hidden;
            }
            .timediv {
                position: relative;
                top: 15px;
                left: -23px;
            }
            #times {
                background: white;
            }
            .hover {
                background: aliceblue;
            }
        </style>
    </head>
    <body>
    <div id="container">
        <div class="ui-widget" id="addform">
            <form onsubmit="return addCourse()">
            <label for="add">Course: </label>
            <input type="text" id="add" />
            <input type="button" value="Add" onclick="addCourse()" />
            </form>
        </div>
        <div id="timetable_wrapper">
            <table id="timetable" cellspacing="0" cellpadding="0">
                <colgroup></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <colgroup span="2"></colgroup>
                <tbody id="times">
                    <tr>
                    <td></td>
                    <td class="time"><div class="timediv">0800</div></td>
                    <td class="time alt"><div class="timediv">0830</div></td>
                    <td class="time"><div class="timediv">0900</div></td>
                    <td class="time alt"><div class="timediv">0930</div></td>
                    <td class="time"><div class="timediv">1000</div></td>
                    <td class="time alt"><div class="timediv">1030</div></td>
                    <td class="time"><div class="timediv">1100</div></td>
                    <td class="time alt"><div class="timediv">1130</div></td>
                    <td class="time"><div class="timediv">1200</div></td>
                    <td class="time alt"><div class="timediv">1230</div></td>
                    <td class="time"><div class="timediv">1300</div></td>
                    <td class="time alt"><div class="timediv">1330</div></td>
                    <td class="time"><div class="timediv">1400</div></td>
                    <td class="time alt"><div class="timediv">1430</div></td>
                    <td class="time"><div class="timediv">1500</div></td>
                    <td class="time alt"><div class="timediv">1530</div></td>
                    <td class="time"><div class="timediv">1600</div></td>
                    <td class="time alt"><div class="timediv">1630</div></td>
                    <td class="time"><div class="timediv">1700</div></td>
                    <td class="time alt"><div class="timediv">1730</div></td>
                    <td class="time"><div class="timediv">1800</div></td>
                    <td class="time alt"><div class="timediv">1830</div></td>
                    <td class="time"><div class="timediv">1900</div></td>
                    <td class="time alt"><div class="timediv">1930</div></td>
                    <td class="time"><div class="timediv">2000</div></td>
                    <td class="time alt"><div class="timediv">2030</div></td>
                    <td class="time"><div class="timediv">2100</div></td>
                    </tr>
                </tbody>
                <tbody id="Mo">
                    <th>MON</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="Tu">
                    <th>TUE</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="We">
                    <th>WED</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="Th">
                    <th>THU</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="Fr">
                    <th>FRI</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="Sa">
                    <th>SAT</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
                <tbody id="Su">
                    <th>SUN</th>
                    <td class="h08 m00"></td>
                    <td class="h08 m30"></td>
                    <td class="h09 m00"></td>
                    <td class="h09 m30"></td>
                    <td class="h10 m00"></td>
                    <td class="h10 m30"></td>
                    <td class="h11 m00"></td>
                    <td class="h11 m30"></td>
                    <td class="h12 m00"></td>
                    <td class="h12 m30"></td>
                    <td class="h13 m00"></td>
                    <td class="h13 m30"></td>
                    <td class="h14 m00"></td>
                    <td class="h14 m30"></td>
                    <td class="h15 m00"></td>
                    <td class="h15 m30"></td>
                    <td class="h16 m00"></td>
                    <td class="h16 m30"></td>
                    <td class="h17 m00"></td>
                    <td class="h17 m30"></td>
                    <td class="h18 m00"></td>
                    <td class="h18 m30"></td>
                    <td class="h19 m00"></td>
                    <td class="h19 m30"></td>
                    <td class="h20 m00"></td>
                    <td class="h20 m30"></td>
                </tbody>
            </table>
        </div>
    </div>
    </body>
</html>
